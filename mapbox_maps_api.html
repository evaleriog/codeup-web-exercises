<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mapbox Exercise</title>
    <!-- Mapbox CSS -->
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />
    <!-- Custom CSS -->
    <style>
        #map {
            /* the width and height may be set to any size */
            width: 100%;
            height: 700px;
        }
    </style>
</head>
<body>
    <h1>My Favorite Restaurants in San Antonio</h1>

    <!-- The HTML element that serves as the Mapbox container -->
    <div id='map'></div>

    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
    <script src="js/keys.js"></script>
    <script src="js/mapbox-geocoder-utils.js"></script>
    <!-- Custom JS -->
    <script>
        "use strict";

        var favRestaurants = [{
            name: "Taco Boulevard",
            address: "18360 Blanco Rd, San Antonio, TX 78258",
        }, {
            name: "Carraba's",
            address: "12507 W Interstate 10 78230 San Antonio"
        },{
            name: "Grimaldi's",
            address: "330 E Basse Rd Ste 101, San Antonio, TX 78209"
        }];
        var coordinates;

        mapboxgl.accessToken = mapboxToken;
        var marker;
        var popup;

        var map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/satellite-streets-v10',
            zoom: 11,
        });

        var popupOptions = {
            closeOnClick: false,
            closeButton: false,
            offset: 25
        };

        favRestaurants.forEach(function (restaurant) {
            geocode(restaurant.address, mapboxToken).then(function (result) {
             marker = new mapboxgl.Marker()
                    .setLngLat(result)
                    .addTo(map);

             popup = new mapboxgl.Popup(popupOptions)
                 .setText(restaurant.name);

             marker.setPopup(popup);
            });
        });

       map.setCenter([-98.524526, 29.555179]);

        // geocode(, mapboxToken).then(function (result) {
        //     map.setCenter(result);
        //
        //     var marker = new mapboxgl.Marker()
        //         .setLngLat(result)
        //         .addTo(map);
        //
        //     map.setZoom(16);
        //
        //     var popupOptions = {
        //         closeOnClick: false,
        //         closeButton: false,
        //         offset: 25
        //     };
        //
        //     var popUp = new mapboxgl.Popup(popupOptions)
        //         .setText("Taco Boulevard");
        //
        //     marker.setPopup(popUp);
        //
        // });
    </script>
</body>
</html>